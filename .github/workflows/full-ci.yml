name: Full CI Check

on:
  pull_request:
    types: [opened, synchronize, reopened]
  push:
    branches: [ main, master, develop ]

concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

jobs:
  game-logic-tests:
    name: Game Logic Tests
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v3
      
    - name: Setup Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'
        
    - name: Install dependencies
      run: |
        pip install pytest
        
    - name: Run critical game logic tests
      run: |
        echo "=== 运行关键游戏逻辑测试 ==="
        
        # 测试交易系统
        python -m pytest test_forest.py::TestForestGame::test_trade_success -v
        #python -m pytest test_forest.py::TestForestGame::test_trade_fail_exceeds_limit -v
        
        # 测试捕食系统
        #python -m pytest test_forest.py::TestForestGame::test_hunt_success -v
        #python -m pytest test_forest.py::TestForestGame::test_hunt_fail_reverse -v
        
        # 测试规则系统
        #python -m pytest test_forest.py::TestForestGame::test_check_restraint_12_players -v
        #python -m pytest test_rules.py::TestRestraintRules::test_rank_restraint_chain -v
        
        # 测试具体案例：红桃K捕食黑桃Q
        echo "=== 测试具体案例：红桃K捕食黑桃Q ==="
