name: Full CI Check

on:
  pull_request:
    types: [opened, synchronize, reopened]
  push:
    branches: [ main, master, develop ]

concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

jobs:
  game-logic-tests:
    name: Game Logic Tests
    needs: unit-tests
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v3
      
    - name: Setup Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'
        
    - name: Install dependencies
      run: |
        pip install pytest
        
    - name: Run critical game logic tests
      run: |
        echo "=== è¿è¡Œå…³é”®æ¸¸æˆé€»è¾‘æµ‹è¯• ==="
        
        # æµ‹è¯•äº¤æ˜“ç³»ç»Ÿ
        #python -m pytest test_forest.py::TestForestGame::test_trade_success -v
        #python -m pytest test_forest.py::TestForestGame::test_trade_fail_exceeds_limit -v
        
        # æµ‹è¯•æ•é£Ÿç³»ç»Ÿ
        #python -m pytest test_forest.py::TestForestGame::test_hunt_success -v
        #python -m pytest test_forest.py::TestForestGame::test_hunt_fail_reverse -v
        
        # æµ‹è¯•è§„åˆ™ç³»ç»Ÿ
        #python -m pytest test_forest.py::TestForestGame::test_check_restraint_12_players -v
        #python -m pytest test_rules.py::TestRestraintRules::test_rank_restraint_chain -v
        
        # æµ‹è¯•å…·ä½“æ¡ˆä¾‹ï¼šçº¢æ¡ƒKæ•é£Ÿé»‘æ¡ƒQ
        echo "=== æµ‹è¯•å…·ä½“æ¡ˆä¾‹ï¼šçº¢æ¡ƒKæ•é£Ÿé»‘æ¡ƒQ ==="
        
  final-validation:
    name: Final Validation
    needs: [game-logic-tests]
    runs-on: ubuntu-latest
    
    steps:
    - name: Check all jobs passed
      run: |
        echo "ğŸ‰ æ‰€æœ‰æ£€æŸ¥é€šè¿‡!"
        echo "æ¸¸æˆé€»è¾‘: âœ…"
        echo ""
        echo "å¯ä»¥å®‰å…¨åœ°åˆå¹¶ä»£ç "
